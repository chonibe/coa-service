{% comment %}
 Certificate of Authenticity Template
 
 This template is designed to be used in a Shopify theme to display
 certificate information for limited edition products.
 
 Usage:
 1. Add this file to your theme's templates directory as page.certificate.liquid
 2. Create a new page in Shopify admin and select "page.certificate" as the template
 3. The page will automatically display certificate information based on the URL parameters
 
 URL Parameters:
 - line_item_id: The ID of the line item to display the certificate for
 - token: Optional verification token
{% endcomment %}

{% layout 'theme' %}

<style>
 .certificate-container {
   max-width: 800px;
   margin: 0 auto;
   padding: 2rem 1rem;
 }
 
 .certificate-card {
   border-radius: 8px;
   overflow: hidden;
   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
   background: white;
 }
 
 .certificate-header {
   background: linear-gradient(to right, #4f46e5, #8b5cf6);
   padding: 2px;
 }
 
 .certificate-content {
   padding: 2rem;
 }
 
 .certificate-title {
   text-align: center;
   margin-bottom: 1.5rem;
 }
 
 .certificate-title h1 {
   font-size: 1.875rem;
   font-weight: 700;
   margin-bottom: 0.5rem;
 }
 
 .certificate-title p {
   color: #6b7280;
   font-size: 1.125rem;
 }
 
 .certificate-image {
   position: relative;
   height: 300px;
   background-color: #f3f4f6;
   border-radius: 8px;
   overflow: hidden;
   margin-bottom: 1.5rem;
 }
 
 .certificate-image img {
   width: 100%;
   height: 100%;
   object-fit: contain;
 }
 
 .certificate-badge {
   position: absolute;
   top: 0.5rem;
   right: 0.5rem;
   background-color: rgba(255, 255, 255, 0.9);
   border: 1px solid rgba(79, 70, 229, 0.3);
   color: #4f46e5;
   padding: 0.25rem 0.75rem;
   border-radius: 9999px;
   font-size: 0.75rem;
   font-weight: 600;
   z-index: 10;
 }
 
 .certificate-details {
   display: grid;
   grid-template-columns: repeat(2, 1fr);
   gap: 1.5rem;
   margin-bottom: 1.5rem;
 }
 
 .detail-card {
   border: 1px solid #e5e7eb;
   border-radius: 0.5rem;
   padding: 1rem;
 }
 
 .detail-card h3 {
   font-size: 0.875rem;
   font-weight: 600;
   color: #4b5563;
   margin-bottom: 0.5rem;
 }
 
 .detail-card p {
   font-size: 1rem;
   font-weight: 500;
 }
 
 .detail-card .detail-note {
   font-size: 0.75rem;
   color: #6b7280;
   margin-top: 0.25rem;
 }
 
 .certificate-description {
   margin-bottom: 1.5rem;
 }
 
 .certificate-description h3 {
   font-size: 1rem;
   font-weight: 600;
   margin-bottom: 0.5rem;
 }
 
 .certificate-description p {
   font-size: 14px;
   color: #4b5563;
   line-height: 1.5;
 }
 
 .certificate-verification {
   display: flex;
   align-items: center;
   color: #10b981;
   font-weight: 500;
 }
 
 .certificate-verification svg {
   margin-right: 0.25rem;
   width: 1rem;
   height: 1rem;
 }
 
 .certificate-actions {
   display: flex;
   gap: 0.5rem;
 }
 
 .certificate-button {
   padding: 10px 20px;
   border-radius: 6px;
   font-size: 14px;
   font-weight: 500;
   cursor: pointer;
   border: none;
   transition: background-color 0.2s;
 }
 
 .certificate-button-primary {
   background-color: #4f46e5;
   color: white;
 }
 
 .certificate-button-outline {
   border: 1px solid #e5e7eb;
   background-color: white;
 }
 
 .certificate-button svg {
   margin-right: 0.25rem;
   width: 1rem;
   height: 1rem;
 }
 
 .certificate-error {
   text-align: center;
   padding: 2rem;
 }
 
 .certificate-error-icon {
   display: flex;
   align-items: center;
   justify-content: center;
   width: 60px;
   height: 60px;
   background-color: #fee2e2;
   color: #ef4444;
   border-radius: 50%;
   font-size: 30px;
   font-weight: bold;
   margin: 0 auto 20px;
 }
 
 .certificate-error h2 {
   font-size: 1.5rem;
   font-weight: 700;
   margin-bottom: 12px;
   color: #111827;
 }
 
 .certificate-error p {
   font-size: 16px;
   color: #6b7280;
   margin-bottom: 1.5rem;
   max-width: 500px;
   margin-left: auto;
   margin-right: auto;
 }
 
 @media print {
   .certificate-actions {
     display: none;
   }
   
   .page-container {
     padding: 0;
   }
   
   .certificate-card {
     box-shadow: none;
     border: 1px solid #e5e7eb;
   }
 }
 
 @media (max-width: 640px) {
   .certificate-info-row {
     flex-direction: column;
   }
   
   .certificate-info-item {
     margin-bottom: 16px;
   }
   
   .certificate-actions {
     flex-direction: column;
   }
 }
</style>

<div class="certificate-container">
 {% if request.parameters.line_item_id %}
   {% assign line_item_id = request.parameters.line_item_id %}
   
   {% comment %}
     In a real implementation, you would fetch the certificate data from your backend API
     For this template, we'll use placeholder data that would be replaced with real data
   {% endcomment %}
   
   {% assign certificate_found = true %}
   {% assign certificate_error = false %}
   
   {% comment %}
     Example of how you would fetch data from your API
     This would be replaced with actual API calls in your implementation
     
     {% assign api_url = "https://your-api-endpoint.com/api/certificate/" | append: line_item_id %}
     {% assign certificate_response = api_url | http_get %}
     {% if certificate_response.success %}
       {% assign certificate = certificate_response.certificate %}
     {% else %}
       {% assign certificate_found = false %}
       {% assign certificate_error = certificate_response.message %}
     {% endif %}
   {% endcomment %}
   
   {% comment %}
     In a real implementation, you would fetch the certificate data from your backend API
     For this template, we'll use placeholder data that would be replaced with real data
     
     Example of how you would fetch data from your API:
     
     {% capture api_url %}{{ shop.secure_url }}/apps/certificate-app/api/certificate?line_item_id={{ line_item_id }}{% endcapture %}
     {% assign certificate_response = api_url | http_get %}
     {% if certificate_response.success %}
       {% assign certificate = certificate_response.certificate %}
       {% assign certificate_found = true %}
     {% else %}
       {% assign certificate_found = false %}
       {% assign certificate_error = certificate_response.message %}
     {% endif %}
   {% endcomment %}
   
   {% if certificate_found %}
     <div class="certificate-card">
       <div class="certificate-header"></div>
       <div class="certificate-content">
         <div class="certificate-title">
           <h1>Certificate of Authenticity</h1>
           <p>Edition #42 of 100</p>
         </div>
         
         <div class="certificate-image">
           <div class="certificate-badge">Limited Edition</div>
           <img src="{{ 'product-placeholder.jpg' | asset_url }}" alt="Product Image">
         </div>
         
         <div class="certificate-info">
           <div class="certificate-info-row">
             <div class="certificate-info-item">
               <h3>Product</h3>
               <p>Limited Edition Artwork</p>
             </div>
             <div class="certificate-info-item">
               <h3>Artist</h3>
               <p>{{ shop.name }}</p>
             </div>
           </div>
           
           <div class="certificate-info-row">
             <div class="certificate-info-item">
               <h3>Edition</h3>
               <p>#42 of 100</p>
             </div>
             <div class="certificate-info-item">
               <h3>Date</h3>
               <p>{{ 'now' | date: '%B %d, %Y' }}</p>
             </div>
           </div>
           
           <div class="certificate-info-row">
             <div class="certificate-info-item">
               <h3>Order</h3>
               <p>#1001</p>
             </div>
             <div class="certificate-info-item">
               <h3>Owner</h3>
               <p>{{ customer.first_name }} {{ customer.last_name }}</p>
             </div>
           </div>
         </div>
         
         <div class="certificate-description">
           <h3>Product Description</h3>
           <p>This limited edition artwork is part of an exclusive series. Each piece is individually numbered and verified for authenticity.</p>
         </div>
         
         <div class="certificate-verification">
           <div class="certificate-verification-info">
             <p>Verification URL: {{ request.origin }}{{ request.path }}?line_item_id={{ line_item_id }}</p>
             <p>Line Item ID: {{ line_item_id }}</p>
             <p>Verified on: {{ 'now' | date: '%B %d, %Y at %I:%M %p' }}</p>
           </div>
         </div>
         
         <div class="certificate-actions" style="margin-top: 1rem; text-align: center;">
           <button class="certificate-button certificate-button-print" onclick="window.print()">
             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
               <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
               <polyline points="7 10 12 15 17 10"></polyline>
               <line x1="12" y1="15" x2="12" y2="3"></line>
             </svg>
             Print Certificate
           </button>
           
           <button class="certificate-button certificate-button-share" onclick="shareCertificate()">
             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
               <circle cx="18" cy="5" r="3"></circle>
               <circle cx="6" cy="12" r="3"></circle>
               <circle cx="18" cy="19" r="3"></circle>
               <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
               <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
             </svg>
             Share Certificate
           </button>
         </div>
       </div>
     </div>
     
     <script>
       function shareCertificate() {
         if (navigator.share) {
           navigator.share({
             title: 'Certificate of Authenticity - Edition #42',
             text: 'View my certificate of authenticity for Limited Edition Product - Edition #42 of 100',
             url: window.location.href,
           })
           .catch((error) => console.log('Error sharing:', error));
         } else {
           // Fallback to clipboard copy
           navigator.clipboard.writeText(window.location.href);
           alert('Certificate URL copied to clipboard!');
         }
       }
     </script>
   {% else %}
     <div class="certificate-card">
       <div class="certificate-error">
         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
           <circle cx="12" cy="12" r="10"></circle>
           <line x1="12" y1="8" x2="12" y2="12"></line>
           <line x1="12" y1="16" x2="12.01" y2="16"></line>
         </svg>
         <h2>Certificate Error</h2>
         <p>{{ certificate_error | default: "Certificate not found. The provided edition ID may be invalid." }}</p>
         <a href="{{ shop.url }}" class="certificate-button certificate-button-outline">
           Return to Shop
         </a>
       </div>
     </div>
   {% endif %}
 {% else %}
   <div class="certificate-error">
     <div class="certificate-error-icon">!</div>
     <h2>Missing Certificate ID</h2>
     <p>No certificate ID was provided. Please check the URL and try again.</p>
     <a href="{{ shop.url }}" class="certificate-button certificate-button-return">
       Return to Shop
     </a>
   </div>
 {% endif %}
</div>
